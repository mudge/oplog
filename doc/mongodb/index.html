<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="API documentation for the Rust `mongodb` crate.">
    <meta name="keywords" content="rust, rustlang, rust-lang, mongodb">

    <title>mongodb - Rust</title>

    <link rel="stylesheet" type="text/css" href="../rustdoc.css">
    <link rel="stylesheet" type="text/css" href="../main.css">
    

    
    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <nav class="sidebar">
        
        <p class='location'></p><script>window.sidebarCurrent = {name: 'mongodb', ty: 'mod', relpath: '../'};</script>
    </nav>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press ‘S’ to search, ‘?’ for more options…"
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content mod">
<h1 class='fqn'><span class='in-band'>Crate <a class='mod' href=''>mongodb</a></span><span class='out-of-band'><span id='render-detail'>
                   <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">
                       [<span class='inner'>&#x2212;</span>]
                   </a>
               </span><a id='src-0' class='srclink' href='../src/mongodb/lib.rs.html#1-419' title='goto source code'>[src]</a></span></h1>
<div class='docblock'>
<h1 id='mongodb-rust-driver' class='section-header'><a href='#mongodb-rust-driver'>MongoDB Rust Driver</a></h1>
<p>A driver written in pure Rust, providing a native interface to MongoDB.</p>

<h2 id='connecting-to-mongodb' class='section-header'><a href='#connecting-to-mongodb'>Connecting to MongoDB</a></h2>
<p>The Client is an entry-point to interacting with a MongoDB instance.</p>

<pre class='rust rust-example-rendered'>
<span class='comment'>// Direct connection to a server. Will not look for other servers in the topology.</span>
<span class='kw'>let</span> <span class='ident'>client</span> <span class='op'>=</span> <span class='ident'>Client</span>::<span class='ident'>connect</span>(<span class='string'>&quot;localhost&quot;</span>, <span class='number'>27017</span>)
    .<span class='ident'>expect</span>(<span class='string'>&quot;Failed to initialize client.&quot;</span>);

<span class='comment'>// Connect to a complex server topology, such as a replica set</span>
<span class='comment'>// or sharded cluster, using a connection string uri.</span>
<span class='kw'>let</span> <span class='ident'>client</span> <span class='op'>=</span> <span class='ident'>Client</span>::<span class='ident'>with_uri</span>(<span class='string'>&quot;mongodb://localhost:27017,localhost:27018/&quot;</span>)
    .<span class='ident'>expect</span>(<span class='string'>&quot;Failed to initialize client.&quot;</span>);

<span class='comment'>// Specify a read preference, and rely on the driver to find secondaries.</span>
<span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>options</span> <span class='op'>=</span> <span class='ident'>ClientOptions</span>::<span class='ident'>new</span>();
<span class='ident'>options</span>.<span class='ident'>read_preference</span> <span class='op'>=</span> <span class='prelude-val'>Some</span>(<span class='ident'>ReadPreference</span>::<span class='ident'>new</span>(<span class='ident'>ReadMode</span>::<span class='ident'>SecondaryPreferred</span>, <span class='prelude-val'>None</span>));
<span class='kw'>let</span> <span class='ident'>client</span> <span class='op'>=</span> <span class='ident'>Client</span>::<span class='ident'>with_uri_and_options</span>(<span class='string'>&quot;mongodb://localhost:27017/&quot;</span>, <span class='ident'>options</span>)
    .<span class='ident'>expect</span>(<span class='string'>&quot;Failed to initialize client.&quot;</span>);</pre>

<h2 id='interacting-with-mongodb-collections' class='section-header'><a href='#interacting-with-mongodb-collections'>Interacting with MongoDB Collections</a></h2>
<pre class='rust rust-example-rendered'>
<span class='kw'>let</span> <span class='ident'>coll</span> <span class='op'>=</span> <span class='ident'>client</span>.<span class='ident'>db</span>(<span class='string'>&quot;media&quot;</span>).<span class='ident'>collection</span>(<span class='string'>&quot;movies&quot;</span>);
<span class='ident'>coll</span>.<span class='ident'>insert_one</span>(<span class='macro'>doc</span><span class='macro'>!</span>{ <span class='string'>&quot;title&quot;</span> <span class='op'>=&gt;</span> <span class='string'>&quot;Back to the Future&quot;</span> }, <span class='prelude-val'>None</span>).<span class='ident'>unwrap</span>();
<span class='ident'>coll</span>.<span class='ident'>update_one</span>(<span class='macro'>doc</span><span class='macro'>!</span>{}, <span class='macro'>doc</span><span class='macro'>!</span>{ <span class='string'>&quot;director&quot;</span> <span class='op'>=&gt;</span> <span class='string'>&quot;Robert Zemeckis&quot;</span> }, <span class='prelude-val'>None</span>).<span class='ident'>unwrap</span>();
<span class='ident'>coll</span>.<span class='ident'>delete_many</span>(<span class='macro'>doc</span><span class='macro'>!</span>{}, <span class='prelude-val'>None</span>).<span class='ident'>unwrap</span>();

<span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>cursor</span> <span class='op'>=</span> <span class='ident'>coll</span>.<span class='ident'>find</span>(<span class='prelude-val'>None</span>, <span class='prelude-val'>None</span>).<span class='ident'>unwrap</span>();
<span class='kw'>for</span> <span class='ident'>result</span> <span class='kw'>in</span> <span class='ident'>cursor</span> {
    <span class='kw'>if</span> <span class='kw'>let</span> <span class='prelude-val'>Ok</span>(<span class='ident'>item</span>) <span class='op'>=</span> <span class='ident'>result</span> {
        <span class='kw'>if</span> <span class='kw'>let</span> <span class='prelude-val'>Some</span>(<span class='kw-2'>&amp;</span><span class='ident'>Bson</span>::<span class='ident'>String</span>(<span class='kw-2'>ref</span> <span class='ident'>title</span>)) <span class='op'>=</span> <span class='ident'>item</span>.<span class='ident'>get</span>(<span class='string'>&quot;title&quot;</span>) {
            <span class='macro'>println</span><span class='macro'>!</span>(<span class='string'>&quot;title: {}&quot;</span>, <span class='ident'>title</span>);
        }
    }
}</pre>

<h2 id='command-monitoring' class='section-header'><a href='#command-monitoring'>Command Monitoring</a></h2>
<p>The driver provides an intuitive interface for monitoring and responding to runtime information
about commands being executed on the server. Arbitrary functions can be used as start and
completion hooks, reacting to command results from the server.</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>fn</span> <span class='ident'>log_query_duration</span>(<span class='ident'>client</span>: <span class='ident'>Client</span>, <span class='ident'>command_result</span>: <span class='kw-2'>&amp;</span><span class='ident'>CommandResult</span>) {
    <span class='kw'>match</span> <span class='ident'>command_result</span> {
        <span class='kw-2'>&amp;</span><span class='ident'>CommandResult</span>::<span class='ident'>Success</span> { <span class='ident'>duration</span>, .. } <span class='op'>=&gt;</span> {
            <span class='macro'>println</span><span class='macro'>!</span>(<span class='string'>&quot;Command took {} nanoseconds.&quot;</span>, <span class='ident'>duration</span>);
        },
        _ <span class='op'>=&gt;</span> <span class='macro'>println</span><span class='macro'>!</span>(<span class='string'>&quot;Failed to execute command.&quot;</span>),
    }
}

<span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>client</span> <span class='op'>=</span> <span class='ident'>Client</span>::<span class='ident'>connect</span>(<span class='string'>&quot;localhost&quot;</span>, <span class='number'>27017</span>).<span class='ident'>unwrap</span>();
<span class='ident'>client</span>.<span class='ident'>add_completion_hook</span>(<span class='ident'>log_query_duration</span>).<span class='ident'>unwrap</span>();</pre>

<h2 id='topology-monitoring' class='section-header'><a href='#topology-monitoring'>Topology Monitoring</a></h2>
<p>Each server within a MongoDB server set is monitored asynchronously for changes in status, and
the driver&#39;s view of the current topology is updated in response to this. This allows the
driver to be aware of the status of the server set it is communicating with, and to make server
selections appropriately with regards to the user-specified <code>ReadPreference</code> and <code>WriteConcern</code>.</p>

<h2 id='connection-pooling' class='section-header'><a href='#connection-pooling'>Connection Pooling</a></h2>
<p>Each server within a MongoDB server set is maintained by the driver with a separate connection
pool. By default, each pool has a maximum of 5 concurrent open connections.</p>
</div><h2 id='reexports' class='section-header'><a href="#reexports">Reexports</a></h2>
<table><tr><td><code>pub use error::{<a class='enum' href='../mongodb/error/enum.Error.html' title='mongodb::error::Error'>Error</a>, <a class='enum' href='../mongodb/error/enum.ErrorCode.html' title='mongodb::error::ErrorCode'>ErrorCode</a>, <a class='type' href='../mongodb/error/type.Result.html' title='mongodb::error::Result'>Result</a>};</code></td></tr></table><h2 id='modules' class='section-header'><a href="#modules">Modules</a></h2>
<table>
                       <tr class=' module-item'>
                           <td><a class='mod' href='coll/index.html'
                                  title='mongodb::coll'>coll</a></td>
                           <td class='docblock-short'>
                                <p>Interface for collection-level operations.</p>
                           </td>
                       </tr>
                       <tr class=' module-item'>
                           <td><a class='mod' href='common/index.html'
                                  title='mongodb::common'>common</a></td>
                           <td class='docblock-short'>
                                <p>Library-wide utilities.</p>
                           </td>
                       </tr>
                       <tr class=' module-item'>
                           <td><a class='mod' href='connstring/index.html'
                                  title='mongodb::connstring'>connstring</a></td>
                           <td class='docblock-short'>
                                <p>Connection string parsing and options.</p>
                           </td>
                       </tr>
                       <tr class=' module-item'>
                           <td><a class='mod' href='cursor/index.html'
                                  title='mongodb::cursor'>cursor</a></td>
                           <td class='docblock-short'>
                                <p>Iterable network cursor for MongoDB queries.</p>
                           </td>
                       </tr>
                       <tr class=' module-item'>
                           <td><a class='mod' href='db/index.html'
                                  title='mongodb::db'>db</a></td>
                           <td class='docblock-short'>
                                <p>Interface for database-level operations.</p>
                           </td>
                       </tr>
                       <tr class=' module-item'>
                           <td><a class='mod' href='error/index.html'
                                  title='mongodb::error'>error</a></td>
                           <td class='docblock-short'>
                                <p>MongoDB Errors and Error Codes.</p>
                           </td>
                       </tr>
                       <tr class=' module-item'>
                           <td><a class='mod' href='gridfs/index.html'
                                  title='mongodb::gridfs'>gridfs</a></td>
                           <td class='docblock-short'>
                                <p>Specification for storing and retrieving files that exceed 16MB within MongoDB.</p>
                           </td>
                       </tr>
                       <tr class=' module-item'>
                           <td><a class='mod' href='pool/index.html'
                                  title='mongodb::pool'>pool</a></td>
                           <td class='docblock-short'>
                                <p>Connection pooling for a single MongoDB server.</p>
                           </td>
                       </tr>
                       <tr class=' module-item'>
                           <td><a class='mod' href='topology/index.html'
                                  title='mongodb::topology'>topology</a></td>
                           <td class='docblock-short'>
                                <p>MongoDB server set topology and asynchronous monitoring.</p>
                           </td>
                       </tr>
                       <tr class=' module-item'>
                           <td><a class='mod' href='wire_protocol/index.html'
                                  title='mongodb::wire_protocol'>wire_protocol</a></td>
                           <td class='docblock-short'>
                                <p>Low-level client-server communication over the MongoDB wire protocol.</p>
                           </td>
                       </tr></table><h2 id='structs' class='section-header'><a href="#structs">Structs</a></h2>
<table>
                       <tr class=' module-item'>
                           <td><a class='struct' href='struct.ClientInner.html'
                                  title='mongodb::ClientInner'>ClientInner</a></td>
                           <td class='docblock-short'>
                                <p>Interfaces with a MongoDB server or replica set.</p>
                           </td>
                       </tr>
                       <tr class=' module-item'>
                           <td><a class='struct' href='struct.ClientOptions.html'
                                  title='mongodb::ClientOptions'>ClientOptions</a></td>
                           <td class='docblock-short'>
                                <p>Configuration options for a client.</p>
                           </td>
                       </tr>
                       <tr class=' module-item'>
                           <td><a class='struct' href='struct.CommandStarted.html'
                                  title='mongodb::CommandStarted'>CommandStarted</a></td>
                           <td class='docblock-short'>
                                <p>Contains the information about a given command that started.</p>
                           </td>
                       </tr></table><h2 id='enums' class='section-header'><a href="#enums">Enums</a></h2>
<table>
                       <tr class=' module-item'>
                           <td><a class='enum' href='enum.CommandResult.html'
                                  title='mongodb::CommandResult'>CommandResult</a></td>
                           <td class='docblock-short'>
                                <p>Contains the information about a given command that completed.</p>
                           </td>
                       </tr>
                       <tr class=' module-item'>
                           <td><a class='enum' href='enum.CommandType.html'
                                  title='mongodb::CommandType'>CommandType</a></td>
                           <td class='docblock-short'>
                                <p>Executable command types that can be monitored by the driver.</p>
                           </td>
                       </tr></table><h2 id='traits' class='section-header'><a href="#traits">Traits</a></h2>
<table>
                       <tr class=' module-item'>
                           <td><a class='trait' href='trait.ThreadedClient.html'
                                  title='mongodb::ThreadedClient'>ThreadedClient</a></td>
                           <td class='docblock-short'>
                                
                           </td>
                       </tr></table><h2 id='types' class='section-header'><a href="#types">Type Definitions</a></h2>
<table>
                       <tr class=' module-item'>
                           <td><a class='type' href='type.Client.html'
                                  title='mongodb::Client'>Client</a></td>
                           <td class='docblock-short'>
                                
                           </td>
                       </tr></table></section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <aside id="help" class="hidden">
        <div>
            <h1 class="hidden">Help</h1>

            <div class="shortcuts">
                <h2>Keyboard Shortcuts</h2>

                <dl>
                    <dt>?</dt>
                    <dd>Show this help dialog</dd>
                    <dt>S</dt>
                    <dd>Focus the search field</dd>
                    <dt>&larrb;</dt>
                    <dd>Move up in search results</dd>
                    <dt>&rarrb;</dt>
                    <dd>Move down in search results</dd>
                    <dt>&#9166;</dt>
                    <dd>Go to active search result</dd>
                    <dt>+</dt>
                    <dd>Collapse/expand all sections</dd>
                </dl>
            </div>

            <div class="infos">
                <h2>Search Tricks</h2>

                <p>
                    Prefix searches with a type followed by a colon (e.g.
                    <code>fn:</code>) to restrict the search to a given type.
                </p>

                <p>
                    Accepted types are: <code>fn</code>, <code>mod</code>,
                    <code>struct</code>, <code>enum</code>,
                    <code>trait</code>, <code>type</code>, <code>macro</code>,
                    and <code>const</code>.
                </p>

                <p>
                    Search functions by type signature (e.g.
                    <code>vec -> usize</code> or <code>* -> vec</code>)
                </p>
            </div>
        </div>
    </aside>

    

    <script>
        window.rootPath = "../";
        window.currentCrate = "mongodb";
    </script>
    <script src="../jquery.js"></script>
    <script src="../main.js"></script>
    <script defer src="../search-index.js"></script>
</body>
</html>